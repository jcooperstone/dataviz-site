---
title: "Module 2 Assignment"
author: "Jessica Cooperstone"
date: "2022-09-20"
output:
  html_document:
    toc: true
    toc_depth: 4
    toc_float: true
    theme: flatly
    code_download: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction
This is your assignment for Module 2, focused on the material you learned in the lectures and recitation activities on [RMarkdown](2_03_rmarkdown/03_Rmd.html), [ggplot101](2_04_ggplot/04_ggplot.html), and [ggplot102](2_05_themes_labels_facets/05_ggplot102.html). 

You will submit this assignment by uploading a knitted .html to Carmen. Make sure you include the Code Download button so that I can see your code as well. Customize the YAML and the document so you like how it looks.

Remember there are often many ways to reach the same end product.

### Data
The data we will be using is collected by the National Science Foundation about the fields and number of Ph.D. degrees awarded each year.
```{r, message = FALSE, warning = FALSE}
phd_field <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-02-19/phd_by_field.csv")
```

```{r, warning = FALSE, message = FALSE}
library(tidyverse)
```

Take a look at the data collected by NSF on how which fields give PhDs each year, and how many are awarded.

## Writing in Markdown 1

Using coding in text, write a sentence in markdown that pulls from this data how many total PhDs were awarded in 2017. If you want to make some calculations in a code chunk first that is ok.

```{r}
phds_2017 <- phd_field %>%
  filter(year == 2017) %>%
  select(n_phds) %>%
  colSums(na.rm = TRUE)
```

In 2017, there were were `r format(phds_2017, scientific = F, big.mark = ",")` Ph.D. degrees awarded in the United States.

In 2017, there were `r phd_field %>% filter(year == 2017) %>% select(n_phds) %>% colSums(na.rm = TRUE) %>% format(scientific = F, big.mark = ",")` Ph.D. degrees awarded in the United States.

## Visualization 1
Make a chart to visualize of the total number of PhDs awarded for each `broad_field` across the total time period of this data. You pick the type of chart that you think is appropriate, and make sure your plot is appropriately labelled and you are happy with how it looks. Hint, to do this you'll probably have to do some data wrangling first.

```{r}
# calculated the median number of phds awarded across each fi
broad_field_sum <- phd_field %>%
  group_by(broad_field) %>%
  summarize(broad_field_sum = sum(n_phds, na.rm = TRUE)) %>%
  arrange(-broad_field_sum)

broad_field_sum %>%
  ggplot(aes(x = broad_field_sum, y = fct_reorder(broad_field, broad_field_sum))) +
  geom_col(color = "black", fill = "grey") +
  theme_minimal() +
  labs(x = "Broad field",
       y = "Number of PhDs awarded from 2008-2017",
       title = "Number of PhDs awarded across different disciplines \nfrom 2008-2017",
       caption = "Data collected by the National Science Foundation")
```

## Visualization 2

Pick the `field` that most closely matches the area of your degree. Make a line graph (with points for each datapoint) that shows how the number of PhDs awarded in your `field` has changed from 2008 to 2017. Make sure your x-axis indicates each year for which you have data, your graph is appropriately labelled, and you think it is aesthetically pleasing.

```{r}
phd_field %>%
  select(broad_field) %>%
  unique()

phd_field %>%
  filter(major_field == "Agricultural sciences and natural resources") %>%
  select(field) %>%
  unique()
```

```{r}
phd_field %>%
  filter(field == "Horticulture science") %>%
  ggplot(aes(x = year, y = n_phds)) +
  geom_point() +
  geom_line() +
  scale_x_continuous(breaks = seq(2008, 2017, 1)) +
  theme_minimal() +
  labs(x = "Year",
       y = "Number of Ph.D. Degrees Awarded",
       title = "Number of Ph.D. Degrees Awarded in Horticulture Science in the United States",
       subtitle = "Data collected by the National Science Foundation")
```

## Visualization 3

Pick at least 3 additional fields (you can use more if you like) that are adjacent to your Ph.D. field. Make a faceted plot to show the number of degrees awarded in each of these disciplines across the same time period. Make sure you label your plot appropriately and you think it is aesthetic (i.e., if you have squished strip text you want to fix that).

```{r}
plant_sci <- c("Agricultural and horticultural plant breeding",
               "Agronomy and crop science",
               "Horticulture science",
               "Plant pathology and phytopathology, agricultural",
               "Plant sciences, other")

phd_field %>%
  filter(field %in% plant_sci) %>%
  ggplot(aes(x = year, y = n_phds)) +
  geom_point() +
  geom_line() +
  scale_x_continuous(breaks = seq(2008, 2017, 1)) +
  facet_wrap(vars(field), labeller = label_wrap_gen()) +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90)) +
  labs(x = "Year",
       y = "Number of Ph.D. Degrees Awarded",
       title = "Number of Ph.D. Degrees Awarded in Plant Science Subdisciplines in the United States",
       subtitle = "Data collected by the National Science Foundation")
```



